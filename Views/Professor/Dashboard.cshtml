@model UniversityApp.Models.Professor.ProfessorDashboardViewModel
@{
    Layout = "_Layout";
}

<h2>Professor Dashboard</h2>

@foreach (var cls in Model.Classes)
{
    <div class="card mb-4">
        <div class="card-header">
            <strong>@cls.ClassName</strong>
        </div>

        <div class="card-body">
            @if (cls.Students.Count == 0)
            {
                <p>No students enrolled.</p>
            }
            else
            {
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Index</th>
                            <th>Name</th>
                            <th>Surname</th>
                            <th>Grade</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var student in cls.Students)
                        {
                            <tr>
                                <td>@student.Index</td>
                                <td>@student.Name</td>
                                <td>@student.Surname</td>
                                <td>
                                    <form method="post" action="/Professor/SetGrade" class="d-flex gap-1">
                                        @Html.AntiForgeryToken()
                                        <input type="hidden" name="studentId" value="@student.StudentId" />
                                        <input type="hidden" name="classId" value="@cls.ClassId" />
                                        <input type="hidden" name="professorId" value="@Model.ProfessorId" />

                                        <input type="text"
                                               name="grade"
                                               value="@(student.Grade.HasValue? student.Grade.ToString() : "")"
                                               pattern="^(5|6|7|8|9|10)$"
                                               title="Grade must be between 5 and 10"
                                               class="form-control form-control-sm"
                                               style="width:70px"
                                               required />

                                        <button type="submit" class="btn btn-sm btn-primary" title="Update Grade">
                                            <i class="bi bi-pencil"></i>
                                        </button>
                                    </form>
                                </td>
                                <td>
                                    <form method="post" action="/Professor/RemoveStudent">
                                        @Html.AntiForgeryToken()
                                        <input type="hidden" name="studentId" value="@student.StudentId" />
                                        <input type="hidden" name="classId" value="@cls.ClassId" />
                                        <input type="hidden" name="professorId" value="@Model.ProfessorId" />
                                        <button type="submit" class="btn btn-sm btn-danger" title="Remove Student">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </form>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            }
        </div>
    </div>
}

<div class="text-end mt-4">
    <a href="/Professor/AddClass?professorId=@Model.ProfessorId"
       class="btn btn-primary">
        + Add Class
    </a>

    <a href="/Professor/AddStudents?professorId=@Model.ProfessorId"
       class="btn btn-secondary me-2">
        + Add Students
    </a>
</div>
